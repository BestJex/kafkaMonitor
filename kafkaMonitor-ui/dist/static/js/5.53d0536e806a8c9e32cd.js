webpackJsonp([5],{Og0r:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o("7I1f");const a="/kafka/operate/getTopicList",s="/kafka/operate/createTopic",r="/kafka/operate/deleteTopic",l="/kafka/operate/topicExists",n="/kafka/operate/getTopicPartitionDetail";var c=o("fc7Y"),p=o.n(c),d=o("PKbQ"),h={name:"",data:()=>({zookeeper:"",zookeeperList:[],topicList:[],partitions:1,replication:1,topic:"hxh_test",topicTableData:[],topicSearch:"",addTopicDialogShow:!1,topicPartitionDetailDialogShow:!1,addTopicForm:{topic:"",replication:2,partitions:4},rules:{},topicPartitionDetailTableData:[],loading:!0,kafkaManagerAddress:"http://10.80.0.77:9000/"}),methods:{zookeeperChangeMethod(){this.getTopicListMethod()},getTopicListMethod(){var t;this.zookeeper&&""!==this.zookeeper?(this.loading=!0,(t=this.zookeeper,i.a.get(a,{zookeeper:t})).then(t=>{if(t){let e=t.data;if(200===e.code){e=e.data,this.topicList=[],this.topicTableData=[];new Date;for(let t=0;t<e.length;t++)this.topicList.push(e[t].topic),this.topicTableData.push(e[t])}}this.loading=!1})):this.loading=!1},getZooKeeperServerListMethod(){Object(d.a)().then(t=>{if(t){let e=t.data;if(200===e.code){e=e.data,this.zookeeperList=[];for(let t=0;t<e.length;t++)this.zookeeperList.push(e[t])}}})},getTopicPartitionDetailMethod(t,e){var o,a;(o=this.zookeeper,a=e.topic,i.a.get(n,{zookeeper:o,topic:a})).then(t=>{if(t){let e=t.data;if(200===e.code){this.topicPartitionDetailTableData=[],e=e.data;for(let t=0;t<e.length;t++)this.topicPartitionDetailTableData.push(e[t]);this.topicPartitionDetailDialogShow=!0}}})},formatCreateDate:function(t,e){let o=new Date(t.createDate);return p.a.format(o,"yyyy-MM-dd HH:mm:ss")},deleteTopicMethod(t,e){(function(t,e){return i.a.get(r,{zookeeper:t,topic:e})})(t,e).then(t=>{if(t){let o=t.data;if(200===o.code){this.$message({showClose:!0,message:e+"删除成功",type:"success"});let t=this.topicTableData;this.topicTableData=[];for(let o=0;o<t.length;o++)t[o].topic!==e&&this.topicTableData.push(t[o])}else this.$message({showClose:!0,message:o.msg,type:"error"})}})},topicExistsMethod(){var t,e;(t=this.zookeeper,e=this.topic,i.a.get(l,{zookeeper:t,topic:e})).then(t=>{if(t){let e=t.data;200===e.code?this.$message({showClose:!0,message:this.topic+"存在",type:"success"}):201===e.code?this.$message({showClose:!0,message:this.topic+"不存在",type:"success"}):this.$message({showClose:!0,message:e.msg,type:"error"})}})},handleEdit(t,e){console.log(t,e)},handleDelete(t,e){this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.deleteTopicMethod(this.zookeeper,e.topic)}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},handleDialogOpen(){this.addTopicDialogShow=!0},handleDialogClose(){this.resetForm("addTopicForm"),this.addTopicDialogShow=!1},submitForm(t){var e,o,a,r;this.$refs[t].validate(t=>{t&&(e=this.zookeeper,o=this.addTopicForm.topic,a=this.addTopicForm.partitions,r=this.addTopicForm.replication,i.a.get(s,{zookeeper:e,topic:o,partitions:a,replication:r})).then(t=>{if(t){let e=t.data;200===e.code?(this.$message({showClose:!0,message:this.topic+"创建成功",type:"success"}),this.getTopicListMethod(),this.handleDialogClose()):this.$message({showClose:!0,message:e.msg,type:"error"})}})})},resetForm(t){this.$nextTick(()=>{void 0!==this.$refs[t]&&this.$refs[t].resetFields()})}},mounted(){this.getZooKeeperServerListMethod(),this.getTopicListMethod()}},m={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"container"},[o("el-row",{staticStyle:{"margin-bottom":"20px"},attrs:{gutter:5}},[o("el-col",{attrs:{span:4,offset:19}},[o("span",[t._v("更多功能：")]),o("el-link",{attrs:{href:t.kafkaManagerAddress,target:"_blank",type:"primary"}},[t._v("KafkaManager")])],1)],1),t._v(" "),o("el-divider"),t._v(" "),o("el-row",{attrs:{gutter:5}},[o("el-col",{attrs:{span:3}},[o("span",[t._v("请选择zookeeper")])]),t._v(" "),o("el-col",{attrs:{span:4}},[o("el-select",{attrs:{placeholder:"请选择zookeeper",size:"mini"},on:{change:t.zookeeperChangeMethod},model:{value:t.zookeeper,callback:function(e){t.zookeeper=e},expression:"zookeeper"}},t._l(t.zookeeperList,function(e,i){return o("el-option",{key:i,attrs:{label:e.name,value:e.address}},[o("span",{staticStyle:{float:"left"}},[t._v(t._s(e.name))]),t._v(" "),o("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v(t._s(e.address))])])}),1)],1),t._v(" "),o("el-col",{attrs:{span:5}},[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.$router.push("/zookeeper/zookeeperServer")}}},[t._v("zookeeper管理\n      ")])],1)],1),t._v(" "),o("el-row",{staticStyle:{margin:"40px 0 0 0"},attrs:{gutter:20}},[o("el-col",{attrs:{span:4}},[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.addTopicDialogShow=!0}}},[t._v("添加Topic")])],1)],1),t._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"870px"},attrs:{data:t.topicTableData.filter(function(e){return!t.topicSearch||e.topic.toLowerCase().includes(t.topicSearch.toLowerCase())})}},[o("el-table-column",{attrs:{prop:"topic",label:"Topic名称",width:"400"}}),t._v(" "),o("el-table-column",{attrs:{sortable:"",prop:"createDate",label:"创建日期",formatter:t.formatCreateDate,width:"150"}}),t._v(" "),o("el-table-column",{attrs:{prop:"createBy",label:"创建人",width:"120"}}),t._v(" "),o("el-table-column",{attrs:{align:"right",width:"200"},scopedSlots:t._u([{key:"header",fn:function(e){return[o("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:t.topicSearch,callback:function(e){t.topicSearch=e},expression:"topicSearch"}})]}},{key:"default",fn:function(e){return[o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"分区详情",placement:"top-start"}},[o("el-button",{attrs:{size:"mini",type:"primary",plain:"",icon:"el-icon-view"},on:{click:function(o){return t.getTopicPartitionDetailMethod(e.$index,e.row)}}})],1),t._v(" "),o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top-start"}},[o("el-button",{attrs:{size:"mini",type:"danger",plain:"",icon:"el-icon-delete"},on:{click:function(o){return t.handleDelete(e.$index,e.row)}}})],1)]}}])})],1),t._v(" "),o("el-dialog",{attrs:{title:"添加Topic",visible:t.addTopicDialogShow,width:"45%"},on:{open:t.handleDialogOpen,close:t.handleDialogClose}},[o("el-form",{ref:"addTopicForm",staticClass:"demo-ruleForm",attrs:{model:t.addTopicForm,"status-icon":"","label-width":"100px"}},[o("el-form-item",{attrs:{label:"Topic名称",prop:"topic"}},[o("el-col",{attrs:{span:20}},[o("el-input",{model:{value:t.addTopicForm.topic,callback:function(e){t.$set(t.addTopicForm,"topic",e)},expression:"addTopicForm.topic"}})],1)],1),t._v(" "),o("el-form-item",{attrs:{label:"分区数",prop:"partitions"}},[o("el-col",{attrs:{span:20}},[o("el-input",{model:{value:t.addTopicForm.partitions,callback:function(e){t.$set(t.addTopicForm,"partitions",e)},expression:"addTopicForm.partitions"}})],1)],1),t._v(" "),o("el-form-item",{attrs:{label:"副本数",prop:"replication"}},[o("el-col",{attrs:{span:20}},[o("el-input",{model:{value:t.addTopicForm.replication,callback:function(e){t.$set(t.addTopicForm,"replication",e)},expression:"addTopicForm.replication"}})],1)],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.addTopicDialogShow=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("addTopicForm")}}},[t._v("添 加")])],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"分区详情",visible:t.topicPartitionDetailDialogShow,width:"55%"},on:{"update:visible":function(e){t.topicPartitionDetailDialogShow=e}}},[o("el-table",{staticStyle:{width:"800px"},attrs:{data:t.topicPartitionDetailTableData}},[o("el-table-column",{attrs:{prop:"topic",label:"Topic",width:"350"}}),t._v(" "),o("el-table-column",{attrs:{prop:"partition",label:"分区",width:"50"}}),t._v(" "),o("el-table-column",{attrs:{prop:"address",label:"副本分布",width:"400"}})],1)],1)],1)},staticRenderFns:[]};var u=o("VU/8")(h,m,!1,function(t){o("ftVb")},"data-v-a10b907c",null);e.default=u.exports},PKbQ:function(t,e,o){"use strict";e.a=function(){return i.a.get(a)},e.b=function(t,e,o){return i.a.post(s,{address:t,name:e,deleted:o})},e.c=function(t){return i.a.get(r,{address:t})};var i=o("7I1f");const a="/zookeeper/getZooKeeperServerList",s="/zookeeper/save",r="/zookeeper/testConn"},ftVb:function(t,e){}});
//# sourceMappingURL=5.53d0536e806a8c9e32cd.js.map