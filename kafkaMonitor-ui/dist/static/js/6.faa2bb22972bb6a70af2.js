webpackJsonp([6],{"3JmX":function(e,t){},JM0i:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("PKbQ"),o=s("fc7Y"),r=s.n(o),n={name:"zookeeperServer",data:()=>({addressSearch:"",form:{address:"",name:""},rules:{address:[{validator:(e,t,s)=>{""===t?s(new Error("请输入服务地址")):new RegExp("[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]").test(t)||s(new Error("服务地址非法(示例:10.80.0.55:2181)"));s()},trigger:"blur"}],name:[{validator:(e,t,s)=>{if(!t||""===t)return s(new Error("请输入名称"));s()},trigger:"blur"}]},addZooKeeperDialogShow:!1,testingConn:!1,zookeeperTableData:[],loading:!1}),methods:{formatCreateDate:function(e,t){let s=new Date(e.createDate);return r.a.format(s,"yyyy-MM-dd HH:mm:ss")},onSubmit(e){this.$refs[e].validate(e=>{e&&Object(a.b)(this.form.address,this.form.name,!1).then(e=>{if(e){let t=e.data.code;console.info(e.data),200===t?(this.$message({showClose:!0,message:"添加成功",type:"success"}),this.handleDialogClose(),this.getZooKeeperServerListMethod()):this.$message({showClose:!0,message:"添加失败:"+e.data.msg,type:"error"})}this.testingConn=!1})})},deleteZookeeperMethod(e,t){Object(a.b)(e,t,!0).then(e=>{if(e){let t=e.data.code;console.info(e.data),200===t?(this.$message({showClose:!0,message:"删除成功",type:"success"}),this.getZooKeeperServerListMethod()):this.$message({showClose:!0,message:"删除失败:"+e.data.msg,type:"error"})}this.testingConn=!1})},getZooKeeperServerListMethod(){this.loading=!0,Object(a.a)().then(e=>{if(e){let t=e.data;if(200===t.code){t=t.data,this.zookeeperTableData=[];for(let e=0;e<t.length;e++)this.zookeeperTableData.push(t[e])}}}),this.loading=!1},handleDialogClose(){this.resetForm("form"),this.addZooKeeperDialogShow=!1},handleDialogOpen(){this.addZooKeeperDialogShow=!0},handleDelete(e,t){this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.deleteZookeeperMethod(t.address,t.name)}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},resetForm(e){this.$nextTick(()=>{void 0!==this.$refs[e]&&this.$refs[e].resetFields()})},checkAddress(e){if(""!==e){if(!new RegExp("[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]").test(e))return void this.$message({showClose:!0,message:"服务地址非法(示例:10.80.0.55:2181)",type:"error"});this.testingConn=!0,Object(a.c)(e).then(e=>{if(e){200!==e.data.code?this.$notify.error({title:"服务不可用",message:e.data.msg}):this.$notify({title:"连接成功",type:"success"})}this.testingConn=!1})}else this.$message({showClose:!0,message:"请输入服务地址",type:"error"})}},mounted(){this.getZooKeeperServerListMethod()}},i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("el-row",{staticStyle:{margin:"40px 0 0 0"},attrs:{gutter:20}},[s("el-col",{attrs:{span:4}},[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.addZooKeeperDialogShow=!0}}},[e._v("添加zookeeper")])],1)],1),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"920px"},attrs:{data:e.zookeeperTableData.filter(function(t){return!e.addressSearch||t.address.toLowerCase().includes(e.addressSearch.toLowerCase())})}},[s("el-table-column",{attrs:{prop:"name",label:"名称",width:"200"}}),e._v(" "),s("el-table-column",{attrs:{prop:"address",label:"zookeeper地址",width:"200"}}),e._v(" "),s("el-table-column",{attrs:{sortable:"",prop:"createDate",label:"创建日期",formatter:e.formatCreateDate,width:"200"}}),e._v(" "),s("el-table-column",{attrs:{prop:"createBy",label:"创建人",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{align:"right",width:"200"},scopedSlots:e._u([{key:"header",fn:function(t){return[s("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.addressSearch,callback:function(t){e.addressSearch=t},expression:"addressSearch"}})]}},{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top-start"}},[s("el-button",{attrs:{size:"mini",type:"danger",plain:"",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}})],1)]}}])})],1),e._v(" "),s("el-dialog",{attrs:{title:"添加",visible:e.addZooKeeperDialogShow,width:"40%"},on:{open:e.handleDialogOpen,close:e.handleDialogClose}},[s("el-form",{ref:"form",staticClass:"demo-ruleForm",attrs:{model:e.form,"status-icon":"",rules:e.rules,"label-width":"150px"}},[s("el-form-item",{attrs:{label:"名称",prop:"name"}},[s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:15}},[s("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"服务地址",prop:"address"}},[s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:15}},[s("el-input",{attrs:{autocomplete:"off",placeholder:"ip:port"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),e._v(" "),s("el-col",{attrs:{span:5}},[s("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.testingConn,expression:"!testingConn"}],on:{click:function(t){return e.checkAddress(e.form.address)}}},[e._v("连接测试")]),e._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.testingConn,expression:"testingConn"}],attrs:{disabled:""}},[e._v("正在连接 "),s("i",{staticClass:"el-icon-loading"})])],1)],1)],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("form")}}},[e._v("确定")]),e._v(" "),s("el-button",{on:{click:function(t){return e.handleDialogClose()}}},[e._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]};var l=s("VU/8")(n,i,!1,function(e){s("3JmX")},"data-v-3e702b32",null);t.default=l.exports},PKbQ:function(e,t,s){"use strict";t.a=function(){return a.a.get(o)},t.b=function(e,t,s){return a.a.post(r,{address:e,name:t,deleted:s})},t.c=function(e){return a.a.get(n,{address:e})};var a=s("7I1f");const o="/zookeeper/getZooKeeperServerList",r="/zookeeper/save",n="/zookeeper/testConn"}});
//# sourceMappingURL=6.faa2bb22972bb6a70af2.js.map